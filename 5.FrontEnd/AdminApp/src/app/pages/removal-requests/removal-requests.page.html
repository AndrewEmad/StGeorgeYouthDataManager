<div class="animate-slide removal-requests-page">
  <app-content-header
    title="طلبات إزالة مخدومين"
    [subtitle]="'طلبات الخدام لإزالة مخدوم — بالموافقة يتم إما إلغاء التخصيص فقط أو إلغاء التخصيص وتفعيل الحذف حسب نوع الطلب'"
  />

  <app-loader [fullScreen]="true" *ngIf="loading" />

  <p class="error-msg" *ngIf="error">{{ error }}</p>

  <app-empty-state
    *ngIf="!loading && requests.length === 0"
    message="لا توجد طلبات قيد المراجعة"
  />

  <div *ngIf="!loading && requests.length" class="requests-list">
    <app-request-card
      *ngFor="let r of requests"
      [title]="r.studentName"
      [subtitle]="'طلب من: ' + r.requestedByUserName"
      [date]="r.requestedAt"
    >
      <span badges>
        <p class="removal-type" *ngIf="r.removalType === 0"><span class="badge">من قائمته فقط</span></p>
        <p class="removal-type" *ngIf="r.removalType !== 0"><span class="badge">من النظام</span></p>
      </span>
      <div actions>
        <button type="button" class="btn-outline danger" (click)="reject(r.id)" [disabled]="processingId === r.id">رفض</button>
        <button type="button" class="btn-primary" (click)="approve(r.id)" [disabled]="processingId === r.id">
          {{ processingId === r.id ? 'جاري...' : (r.removalType === 0 ? 'موافقة (إزالة من القائمة فقط)' : 'موافقة (إزالة وتفعيل الحذف)') }}
        </button>
      </div>
    </app-request-card>
  </div>
</div>

<div class="animate-slide">
  <app-content-header
    title="أداء الخدام ومتابعة المخدومين"
    subtitle="مكالمات وزيارات هذا الأسبوع"
    backLink="/dashboard/reports/servant-follow-up"
    backLabel="العودة للتقارير"
  />
  <section class="report-section">
    <app-loader *ngIf="loading" />
    <app-card *ngIf="!loading && perfResult" class="table-container">
      <table>
        <thead>
          <tr>
            <th>الخادم</th>
            <th>عدد المخدومين المخصصين</th>
            <th>مكالمات هذا الأسبوع</th>
            <th>زيارات هذا الأسبوع</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let sp of perfResult.items" class="row-clickable" (click)="viewServant(sp.servantId)">
            <td>{{ sp.fullName }}</td>
            <td>{{ sp.assignedStudentsCount }}</td>
            <td>{{ sp.callsThisWeek }}</td>
            <td>{{ sp.visitsThisWeek }}</td>
            <td (click)="$event.stopPropagation()">
              <a [routerLink]="['/dashboard/servants', sp.servantId]" class="btn-outline sm">تفاصيل</a>
            </td>
          </tr>
          <tr *ngIf="perfResult.items.length === 0">
            <td colspan="5" class="text-muted">لا يوجد خدام</td>
          </tr>
        </tbody>
      </table>
    </app-card>
    <app-pagination
      *ngIf="!loading && perfResult && perfResult.totalCount > 0"
      [total]="perfResult.totalCount"
      [page]="page"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      [currentPageCount]="perfResult.items.length"
      (pageChange)="goToPage($event)"
      (pageSizeChange)="setPageSize($event)"
    />
  </section>
</div>
